---
version: dev
last_updated: 2023-07-13
applies_to: crules (current development version)
---

# Agent System

> üß† The Agent System in crules allows you to work with specialized AI agents for different tasks, from planning and implementing features to fixing issues and documenting code.

## Overview

The crules Agent System provides an interactive way to discover, select, and use various AI agents defined in your `.cursor/rules` directory. Each agent is specialized for a particular task, such as:

- Planning new features 
- Fixing bugs and issues
- Implementing code based on plans
- Running and testing implementations
- Creating documentation
- Reviewing code

Agents are defined in Markdown (`.mdc`) files that contain both the agent's metadata (name, description, capabilities) and its full definition.

## Agent Ecosystem

The agents in crules work together as an ecosystem, with different agents specializing in different phases of the development lifecycle. The diagram below illustrates how these agents interact:

```mermaid
graph TD
    %% Main agent nodes
    User((User))
    Wizard([Wizard])
    
    %% Planning agents
    FeaturePlanner[Feature Planner]
    FixPlanner[Fix Planner]
    ArchPlanner[Architecture Planner]
    RefactorGuru[Refactoring Guru]
    ScraperPlanner[Scraper Planner]
    
    %% Implementation agents
    Implementer[Implementer]
    Runner[Runner]
    
    %% Support agents
    CodeReviewer[Code Reviewer]
    GitCommitter[Git Committer]
    DocAgent[Documentation Agent]
    GitAgent[Git Agent]
    
    %% Coordination flow
    User --> Wizard
    Wizard --> Planning
    Wizard --> Implementation
    Wizard --> Support
    
    %% Planning subgraph
    subgraph Planning[" Planning Phase "]
        FeaturePlanner
        FixPlanner
        ArchPlanner
        RefactorGuru
        ScraperPlanner
    end
    
    %% Implementation subgraph
    subgraph Implementation[" Implementation Phase "]
        Implementer
        Runner
    end
    
    %% Support subgraph
    subgraph Support[" Support Phase "]
        CodeReviewer
        GitCommitter
        DocAgent
        GitAgent
    end
    
    %% Inter-agent workflows
    FeaturePlanner ==> Implementer
    FixPlanner ==> Implementer
    ArchPlanner ==> FeaturePlanner
    ArchPlanner ==> Implementer
    RefactorGuru ==> Implementer
    ScraperPlanner ==> Implementer
    
    Implementer ==> Runner
    Runner ==> CodeReviewer
    CodeReviewer ==> GitCommitter
    Implementer ==> DocAgent
    GitCommitter ==> GitAgent
    
    %% Feedback loops
    CodeReviewer -.-> Implementer
    Runner -.-> FixPlanner
    
    %% Title
    Title[Agent Relationships and Workflow]
    style Title fill:none,stroke:none
    
    %% Styles
    classDef userStyle fill:#ff9966,stroke:#ff6600,stroke-width:2px
    classDef wizardStyle fill:#ff66b2,stroke:#cc0066,stroke-width:3px
    classDef plannerStyle fill:#9966ff,stroke:#6600cc,stroke-width:2px
    classDef implementerStyle fill:#66b3ff,stroke:#0066cc,stroke-width:2px
    classDef supportStyle fill:#66cc99,stroke:#009966,stroke-width:2px
    
    class User userStyle
    class Wizard wizardStyle
    class FeaturePlanner,FixPlanner,ArchPlanner,RefactorGuru,ScraperPlanner plannerStyle
    class Implementer,Runner implementerStyle
    class CodeReviewer,GitCommitter,DocAgent,GitAgent supportStyle
    
    style Planning fill:#f5f0ff,stroke:#d5c0ff,stroke-width:2px
    style Implementation fill:#f0f5ff,stroke:#c0d5ff,stroke-width:2px
    style Support fill:#f0fff5,stroke:#c0ffd5,stroke-width:2px
```

*Figure 1: The crules agent ecosystem and interactions*

In this ecosystem:
- The **Technical Wizard** acts as a coordinator, helping users decide which specialized agents to use
- **Planning agents** (purple) work on designing and planning tasks
- **Implementation agents** (blue) execute the plans and verify the results
- **Support agents** (green) handle ancillary tasks like documentation, code review, and version control
- The solid lines show typical workflows, while dotted lines represent feedback loops

This modular approach allows you to use the right agent for each specific task while maintaining a coherent development workflow.

```mermaid
sequenceDiagram
    autonumber
    participant User as User
    participant Wizard as Wizard
    participant Planner as Planner
    participant Implementer as Implementer
    participant Runner as Runner
    participant DocAgent as DocAgent
    
    User->>Wizard: Request guidance for new feature
    activate Wizard
    Wizard-->>User: Explore options & approaches
    Wizard->>Planner: Hand off for detailed planning
    deactivate Wizard
    
    activate Planner
    Planner-->>User: Create step-by-step implementation plan
    Planner->>Implementer: Hand off plan for implementation
    deactivate Planner
    
    activate Implementer
    Implementer-->>User: Write code based on plan
    Implementer->>Runner: Hand off for testing
    deactivate Implementer
    
    activate Runner
    Runner-->>User: Verify implementation works
    Runner->>DocAgent: Hand off for documentation
    deactivate Runner
    
    activate DocAgent
    DocAgent-->>User: Create documentation for the feature
    deactivate DocAgent
    
    Note over User,DocAgent: Complete feature development workflow
```

*Figure 2: Example of a complete agent-assisted development workflow*

## Using Agents

You can interact with agents using the following commands:

- `crules agent` - Display all available agents (default behavior)
- `crules agent info <id>` - Show detailed information about a specific agent
- `crules agent select` - Interactively select and load an agent

You can also reference agents directly in the chatbox using the `@` symbol (e.g., `@wizard.mdc`).

<details>
  <summary>üì∫ View Agent Selection Process</summary>
  <div style="width: 600px; height: 400px; border: 2px dashed #ccc; display: flex; align-items: center; justify-content: center; margin: 20px 0; background-color: #f8f8f8; border-radius: 5px;">
    <div style="text-align: center;">
      <div style="font-size: 48px; margin-bottom: 10px;">ü§ñ</div>
      <div style="font-weight: bold; margin-bottom: 5px;">Agent Selection Process</div>
      <div style="color: #666; font-style: italic;">[Animated demonstration would go here]</div>
    </div>
  </div>
</details>

## Listing Available Agents

To see all available agents, use:

```bash
crules agent
```

This will display a formatted table of all agents with their information. The table adapts to your terminal width to provide the optimal display format:

### Display Examples

**Wide Terminal Display:**
```
+-----+---------------------+--------------------+----------+
| No. | Agent Name          | Reference ID       | Version  |
+-----+---------------------+--------------------+----------+
| 1   | Feature Planner     | @feature-planner.mdc | 1.0    |
| 2   | Fix Planner         | @fix-planner.mdc     | 1.0    |
| 3   | Runner              | @runner.mdc          | 1.0    |
| 4   | Technical Wizard    | @wizard.mdc          | 1.0    |
| ... | ...                 | ...                  | ...    |
+-----+---------------------+--------------------+----------+
```

**Medium Terminal Display:**
```
+-----+----------------+--------------------+
| No. | Name           | Reference          |
+-----+----------------+--------------------+
| 1   | Feature Planner| @feature-planner.mdc |
| 2   | Fix Planner    | @fix-planner.mdc     |
| 3   | Runner         | @runner.mdc          |
| ... | ...            | ...                  |
+-----+----------------+--------------------+
```

**Narrow Terminal Display:**
```
+-----+------------------+
| No. | Agent            |
+-----+------------------+
| 1   | feature-planner  |
| 2   | fix-planner      |
| 3   | runner           |
| ... | ...              |
+-----+------------------+
```

The table format ensures proper alignment and clarity regardless of your terminal size, making agent information easy to read and reference.

## Referencing Agents

There are multiple ways to reference agents in crules, providing flexibility based on your preference and needs.

### Referencing by String ID

You can reference agents by their unique string ID, which is derived from the filename without the `.mdc` extension:

```bash
crules agent info wizard
```

This method is stable across sessions and reorderings of the agent list.

### Referencing by Numeric Index

You can also reference agents by their position number shown in the agent list:

```bash
crules agent info 1  # References the first agent in the list
```

This method is convenient for quick access when you can see the number in the list but might not remember the exact ID.

Benefits of numeric index referencing:
- Shorter to type
- Easier for sequential exploration of agents
- Direct visual correspondence with the displayed list

### Agent @ References

The quickest way to invoke a specific agent in the chatbox is by using the `@` reference. Simply type `@` followed by the agent ID to invoke that agent:

```
@wizard.mdc I need help designing a new API endpoint
```

```
@quick-answer-agent.mdc What does the HTTP 418 status code mean?
```

This method allows you to quickly switch between different agent specializations without running additional commands.

### Agent Info

The `info` command provides detailed information about a specific agent:

```
$ crules agent info wizard

Agent details:
  ID:          wizard
  Name:        üßô‚Äç‚ôÇÔ∏è Technical Wizard Agent
  Version:     1.0

Description:
  [Full agent description with formatted markdown]

Capabilities:
  - In-Depth Technical Exploration and Analysis
  - Expert Architectural Guidance
  - Design Patterns Discussion
  - Clean Code Advisory

File: /Users/username/Library/Application Support/crules/.cursor/rules/wizard.mdc
```

Or using the numeric index:

```
$ crules agent info 6  # Assuming 6 is the position number for the wizard agent

Agent details:
  ID:          wizard
  Name:        üßô‚Äç‚ôÇÔ∏è Technical Wizard Agent
  Version:     1.0
  
  ...
```

### Agent Selection

The `select` command presents an interactive menu for choosing an agent:

1. Run `crules agent select`
2. Browse the list of available agents
3. Enter the number of the agent you want to select
4. The agent will be loaded, and you'll see its details
5. You can optionally view the full agent definition in a paginated format

```
‚îå‚îÄ Select an Agent ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                                     ‚îÇ
‚îÇ  > 1. üßô‚Äç‚ôÇÔ∏è Technical Wizard Agent                    ‚îÇ
‚îÇ    2. ‚ú® Feature Planner Agent                      ‚îÇ
‚îÇ    3. üîç Fix Planner Agent                          ‚îÇ
‚îÇ    4. üõ†Ô∏è Implementer Agent                          ‚îÇ
‚îÇ    5. üèÉ Runner Agent                               ‚îÇ
‚îÇ    6. üìö Documentation Agent                        ‚îÇ
‚îÇ    7. üëÅÔ∏è Code Review Agent                          ‚îÇ
‚îÇ                                                     ‚îÇ
‚îÇ  [Use arrow keys to navigate, Enter to select]      ‚îÇ
‚îÇ                                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

*Figure 3: The agent selection terminal UI*

## Common Agents

The system comes with several pre-defined agents, each specialized in different aspects of software development:

| Agent | Icon | Primary Role | When to Use |
|-------|------|--------------|-------------|
| **Technical Wizard** | üßô‚Äç‚ôÇÔ∏è | High-level guidance & coordination | Starting a project, making architectural decisions |
| **Feature Planner** | ‚ú® | Feature implementation planning | Breaking down new feature requirements |
| **Fix Planner** | üîç | Bug analysis and fix planning | Diagnosing and planning fixes for issues |
| **Implementer** | üõ†Ô∏è | Code implementation | Translating plans into working code |
| **Runner** | üèÉ | Testing and verification | Running and verifying implementations |
| **Documentation Agent** | üìö | Documentation creation | Creating and organizing documentation |
| **Code Reviewer** | üëÅÔ∏è | Code quality assessment | Reviewing code for quality and issues |
| **Git Committer** | üìù | Version control assistance | Creating commit messages and managing changes |

## Recommended Agent Workflows

For the best results, consider these common workflows:

### New Feature Development

1. Start with the **Technical Wizard** to discuss the high-level approach
2. Use the **Feature Planner** to create a detailed implementation plan
3. Have the **Implementer** translate the plan into code
4. Verify with the **Runner** to test the implementation
5. Let the **Documentation Agent** create documentation for the feature
6. Finish with the **Git Committer** to prepare the changes for commit

### Bug Fixing

1. Begin with the **Fix Planner** to analyze the bug
2. Use the **Implementer** to implement the fix
3. Verify with the **Runner** that the bug is resolved
4. Update documentation with the **Documentation Agent** if needed

```mermaid
flowchart LR
    %% Bug Fix Workflow
    subgraph bug["Bug Fix Workflow"]
        direction TB
        a[Report Bug] --> b[Analyze Bug]
        b --> c[Implement Fix]
        c --> d[Test Fix]
        d --> e[Document Changes]
        e --> f[Commit Code]
    end
    
    %% Feature Workflow
    subgraph feat["Feature Workflow"]
        direction TB
        g[Feature Request] --> h[Plan Feature]
        h --> i[Design Implementation]
        i --> j[Write Code]
        j --> k[Test Feature]
        k --> l[Create Documentation]
        l --> m[Review & Commit]
    end
    
    %% Styling
    classDef bugStyle fill:#fee,stroke:#fcc,stroke-width:1px
    classDef featStyle fill:#eef,stroke:#ccf,stroke-width:1px
    
    classDef start fill:#f96,stroke:#f63,stroke-width:2px
    classDef planning fill:#c9f,stroke:#96c,stroke-width:1px
    classDef coding fill:#69f,stroke:#36f,stroke-width:2px
    classDef testing fill:#9cf,stroke:#69c,stroke-width:2px
    classDef docs fill:#fc9,stroke:#c96,stroke-width:2px
    classDef commit fill:#9f9,stroke:#6c6,stroke-width:2px
    
    class bug bugStyle
    class feat featStyle
    
    class a,g start
    class b,h,i planning
    class c,j coding
    class d,k testing
    class e,l docs
    class f,m commit
```

*Figure 4: Workflow diagram comparing feature development and bug fix processes*

<details>
  <summary>üì∫ View Agent Workflow Demonstration</summary>
  <div style="width: 600px; height: 400px; border: 2px dashed #ccc; display: flex; align-items: center; justify-content: center; margin: 20px 0; background-color: #f8f8f8; border-radius: 5px;">
    <div style="text-align: center;">
      <div style="font-size: 48px; margin-bottom: 10px;">‚öôÔ∏è</div>
      <div style="font-weight: bold; margin-bottom: 5px;">Agent Workflow Demonstration</div>
      <div style="color: #666; font-style: italic;">[Animated demonstration of parallel workflows would go here]</div>
    </div>
  </div>
</details>

## Adding Custom Agents

You can add your own custom agents by creating new `.mdc` files in your `.cursor/rules` directory. These agents will automatically be discovered by the crules tool and become available in the agent selection menu.

For information on creating custom agents, see the [Extending the Agent System](../developer-guide/extending-agents.md) guide in the Developer Documentation.

---

## Navigation

- Previous: [Commands](./commands.md)
- Next: [Troubleshooting](./troubleshooting.md)
- Up: [User Guide](../README.md#user-guide)
- Home: [Documentation Home](../README.md) 